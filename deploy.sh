#!/bin/bash

echo "ğŸš€ MotoGarage Production Deployment Script"
echo "=========================================="

# FTP Bilgileri
FTP_HOST="195.35.49.18"
FTP_USER="u456124799.minigaraj.store"
FTP_PORT="21"
UPLOAD_DIR="public_html"

echo "ğŸ“‹ Deployment AdÄ±mlarÄ±:"
echo "1. Frontend build dosyalarÄ± hazÄ±rlanÄ±yor..."
echo "2. Backend JAR dosyasÄ± hazÄ±rlanÄ±yor..."
echo "3. KonfigÃ¼rasyon dosyalarÄ± hazÄ±rlanÄ±yor..."
echo "4. FTP ile dosya yÃ¼kleme talimatlarÄ±..."

echo ""
echo "ğŸ“ YÃ¼klenecek Dosyalar:"
echo "- frontend-build/ â†’ $UPLOAD_DIR/"
echo "- backend.jar â†’ $UPLOAD_DIR/backend/"
echo "- application-prod.properties â†’ $UPLOAD_DIR/backend/"
echo "- start-backend.sh â†’ $UPLOAD_DIR/backend/"
echo "- nginx.conf â†’ sunucu root dizinine"

echo ""
echo "ğŸ”§ Sunucu Kurulum KomutlarÄ±:"
echo "sudo apt update"
echo "sudo apt install postgresql postgresql-contrib openjdk-17-jdk nginx"
echo "sudo systemctl start postgresql"
echo "sudo systemctl enable postgresql"

echo ""
echo "ğŸ—„ï¸ VeritabanÄ± Kurulumu:"
echo "sudo -u postgres psql"
echo "CREATE DATABASE motogarage;"
echo "CREATE USER motogarage_user WITH PASSWORD 'your_secure_password';"
echo "GRANT ALL PRIVILEGES ON DATABASE motogarage TO motogarage_user;"
echo "\\q"

echo ""
echo "ğŸŒ Nginx KonfigÃ¼rasyonu:"
echo "sudo cp nginx.conf /etc/nginx/sites-available/minigaraj.store"
echo "sudo ln -s /etc/nginx/sites-available/minigaraj.store /etc/nginx/sites-enabled/"
echo "sudo nginx -t"
echo "sudo systemctl reload nginx"

echo ""
echo "âš™ï¸ Backend Servis Kurulumu:"
echo "sudo systemctl enable motogarage-backend"
echo "sudo systemctl start motogarage-backend"

echo ""
echo "âœ… Deployment tamamlandÄ±ÄŸÄ±nda test edin:"
echo "curl http://minigaraj.store/api/stock"
echo "curl http://minigaraj.store/health"

echo ""
echo "ğŸ“– DetaylÄ± rehber iÃ§in: DEPLOYMENT_GUIDE.md dosyasÄ±nÄ± inceleyin"
echo ""
echo "ğŸ¯ FTP Bilgileri:"
echo "Host: $FTP_HOST"
echo "User: $FTP_USER"
echo "Port: $FTP_PORT"
echo "Directory: $UPLOAD_DIR"
